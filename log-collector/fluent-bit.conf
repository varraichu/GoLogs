[SERVICE]
    Flush        1
    Log_Level    info
    Daemon       off
    Parsers_File /etc/fluent-bit/parsers.conf
    HTTP_Server  On
    HTTP_Listen  0.0.0.0
    HTTP_Port    2020
    # Add storage configuration for persistence
    Storage.path              /tmp/flb-storage/
    Storage.sync              normal
    Storage.checksum          off
    Storage.backlog.mem_limit 10M

# Input for log files
[INPUT]
    Name              tail
    Path              /demo-app/src/logs/app.log
    Tag               app.file
    DB                /fluent-bit/db/flb_kv.db
    DB.Sync           Normal
    DB.locking        true
    Mem_Buf_Limit     5MB
    # Enable filesystem storage for this input
    storage.type      filesystem

# Input for stdout/stderr (currently commented out - see note below)
# [INPUT]
#     Name              forward
#     Listen            0.0.0.0
#     Port              24224
#     Tag               app.stdout

[OUTPUT]
    Name stdout
    Match *

[OUTPUT]
    Name redis
    Match *
    Hosts redis:6379
    DB 0
    Key logs
    # Robust retry configuration
    Retry_Limit       9999999
    workers           1
    # Storage configuration for buffering
    storage.type              filesystem
    storage.total_limit_size  500M